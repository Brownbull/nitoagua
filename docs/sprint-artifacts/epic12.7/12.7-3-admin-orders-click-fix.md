# Story 12.7-3: Admin Orders Click Fix

| Field | Value |
|-------|-------|
| **Story ID** | 12.7-3 |
| **Epic** | Epic 12.7: Manual Testing Bug Fixes |
| **Title** | Admin Orders Click Fix |
| **Status** | drafted |
| **Priority** | P0 (Critical) |
| **Points** | 3 |
| **Bug Reference** | BUG-007 |

## User Story

**As an** admin viewing orders,
**I want** clicks on order rows to consistently open the details,
**So that** I can reliably manage orders without page refreshes.

## Problem Statement

When clicking on a request row in the admin orders list, sometimes nothing happens. The click doesn't open the request details. This is intermittent - sometimes it works, sometimes it doesn't. A page refresh temporarily fixes it.

## Technical Context

### Component Location
- `src/app/admin/orders/page.tsx` - Admin orders list
- Admin orders table row component
- Order detail modal/sheet component

### Observed Behavior
- Click sometimes works, sometimes doesn't
- No visual feedback when click fails
- Requires page refresh to fix
- Intermittent/unpredictable

### Potential Root Causes
1. **React hydration issue** - Event handler not attached after hydration
2. **Stale closure** - Click handler referencing old state
3. **Race condition** - Data loading vs click handler registration
4. **JS error** - Silent error preventing handler execution
5. **Z-index issue** - Invisible element blocking clicks

## Acceptance Criteria

### AC12.7.3.1: Consistent Click Behavior
- [ ] Every click on an order row opens details
- [ ] No intermittent failures
- [ ] Works immediately after page load
- [ ] Works after filtering/sorting

### AC12.7.3.2: Visual Feedback
- [ ] Row shows hover state on mouse over
- [ ] Loading indicator when opening details
- [ ] Clear feedback if action fails

### AC12.7.3.3: Error Handling
- [ ] Console errors logged if click fails
- [ ] User notified if details can't be opened
- [ ] Graceful degradation (retry option)

### AC12.7.3.4: E2E Test Coverage
- [ ] Test clicking multiple rows in sequence
- [ ] Test clicking after filter changes
- [ ] Test clicking after data refresh

## Investigation Checklist

- [ ] Check browser console for JS errors when click fails
- [ ] Check if specific rows fail vs random rows
- [ ] Check if issue occurs after specific actions (filter, scroll, etc.)
- [ ] Add console.log to click handler to verify it's being called
- [ ] Check for overlapping/invisible elements with DevTools
- [ ] Test with React DevTools to verify hydration

## Implementation Notes

### Debug Steps

1. **Add logging to click handler:**
   ```tsx
   const handleRowClick = (orderId: string) => {
     console.log('Row clicked:', orderId);
     // ... rest of handler
   };
   ```

2. **Check for hydration issues:**
   ```tsx
   // If using client component, ensure proper hydration
   'use client';

   // Or use useEffect to attach handler
   useEffect(() => {
     // Handler setup
   }, []);
   ```

3. **Check for event propagation issues:**
   ```tsx
   <tr onClick={(e) => {
     e.stopPropagation();
     handleRowClick(order.id);
   }}>
   ```

### Common Fixes

- **Hydration mismatch:** Ensure consistent rendering between server/client
- **Stale state:** Use functional updates or refs
- **Event bubbling:** Stop propagation from child elements
- **Missing key prop:** Ensure table rows have stable keys

## Definition of Done

- [ ] Clicks work 100% of the time
- [ ] No console errors on click
- [ ] E2E tests pass
- [ ] Code review approved
- [ ] Deployed to production
- [ ] Verified in Round 2 testing (Test 3.4, 3.5)
