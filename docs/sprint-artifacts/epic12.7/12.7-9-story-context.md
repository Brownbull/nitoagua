# Story 12.7-9: Admin Panel UX Improvements - Story Context

## Technical Analysis

### Bugs Addressed

1. **BUG-002:** Admin orders stale data / no refresh
2. **BUG-006:** Admin orders no sorting by date
3. **BUG-017:** Admin finances navigation issues

### Current Implementation

**Files:**
- `src/app/admin/orders/page.tsx` - Orders list
- `src/app/admin/page.tsx` - Dashboard
- `src/components/admin/admin-sidebar.tsx` - Navigation
- `src/app/admin/settlement/page.tsx` - Finances

### Improvements Needed

#### BUG-002: Stale Data

Options:
1. Add polling (every 30 seconds)
2. Add manual refresh button
3. Improve realtime subscription (covered in 12.7-4)

```tsx
// Polling approach
useEffect(() => {
  const interval = setInterval(() => {
    router.refresh();
  }, 30000);
  return () => clearInterval(interval);
}, []);
```

#### BUG-006: No Sorting

Add sortable columns to orders table:
- Date (created_at) - ascending/descending
- Status
- Amount

```tsx
// Add sort state
const [sortBy, setSortBy] = useState<'date' | 'status' | 'amount'>('date');
const [sortDir, setSortDir] = useState<'asc' | 'desc'>('desc');

// Apply in query
.order(sortBy, { ascending: sortDir === 'asc' })
```

#### BUG-017: Navigation Issues

Review and fix:
- Sidebar active states
- Finances page layout
- Breadcrumbs if needed

### Files to Modify

| File | Changes |
|------|---------|
| `src/app/admin/orders/page.tsx` | Add refresh button, sorting |
| `src/components/admin/orders-table.tsx` | Sortable headers |
| `src/components/admin/admin-sidebar.tsx` | Fix active states |
| `src/app/admin/settlement/page.tsx` | Navigation improvements |

### Acceptance Criteria Mapping

| AC | Bug | Implementation |
|----|-----|----------------|
| AC12.7.9.1 | BUG-002 | Manual refresh button |
| AC12.7.9.2 | BUG-006 | Sortable date column |
| AC12.7.9.3 | BUG-017 | Clear navigation flow |
